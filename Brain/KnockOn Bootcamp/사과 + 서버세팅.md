# 일단..
~여러분 서버 옮기게 되어 죄송함다..~

사과의 의미라고하면 뭐하지만.. 
작업하는데 도움이 될만한 정보를 공유하고자 합니당..
아래의 순서로 환경 세팅을 하면 아마아마 사장님한테 혼나지 않을거에요!

# START~
일단 기존의 작업 폴더는 /tmp에 옮겨놨습니당
급하게 옮겨서 온전히 있지 않을까봐 걱정되네요..


# 작업 공간 만들기!!
저것들을 옮길라면 개인 계정을 만들어야 하니깐..

- 사용자 추가
`sudo adduser [하고싶은 이름]`

앞으로는 개인 계정에는 sudo권한을 뺄거라고 함당
그런데 docker사용하는데는 sudo 권한이 필요해요!
그래서 여러분 계정을 docker 그룹권한에 넣어야만 함다

- docker에 들어있는 유저 보기
`getent group docker`

- docker 그룹 권한에 계정 추가하기
`sudo usermod -aG docker [계정명]`

- 특정유저의 그룹 권한 보기
`groups foo1`

이 정도면 당장 작업하는데 필요한 세팅은 끝날거에요 그런데..


# 비밀번호로 로그인을 못합니다!!!
원래 어떻게 작업했는지 모르겠지만 저는 비밀번호로 로그인을 자주했어요..
근데 이번 사태의 원인 중 하나는 비밀번호를 통해 로그인을 하는 것이었어요.
그래서 특단의 조치! 키로만 로그인할 수 있게하자..!

알죠.. 처음 세팅은 좀 귀찮을 거에요.. 근데 하다보니까 세팅만하면 오히려 비번보다 편하더라구요..

쨋든 키세팅ㄱㄱ


# 키세팅
- 개인 계정으로 로그인 후 디렉토리로 이동
`su [계정명]`
`cd ~`

- 키페어 생성
`ssh-keygen`

- 공개키 홈 디렉에 추가
`cat id_rsa.pub >> ~/.ssh/authorized_keys`

- .pem 파일 생성
`ssh-keygen -p -m PEM -f ~/.ssh/id_rsa`

일단 여기까지 하면 `~/.ssh/id_rsa`라는 파일이 생성될거에요..
근데 이걸 이제 로컬로 들고와야 작업을 할 수 있잖아요?
이걸 `scp`라는 명령어를 통해 가져올 거에요

근!데! 또 이걸 그냥 `scp`로 `ubuntu`권한으로 가져올라하면 권한 오류가 나올거에요
그래서 이름도 이쁘게 바꿔주고 권한에 구애 받지 않는 `/tmp`로 옮긴 다음 작업을 할겁니당

- 파일명 변경 후 `/tmp`로 이동
`mv ~/.ssh/id_rsa /tmp/knockon_[계정명].pem`

- 파일 옮기기
`scp -i [ubuntu 키의 위치] ubuntu@ssh.knock-on.org:/tmp/knockon_[계정명].pem [로컬에서 키를 보관할 위치]`
참고로 위의 scp는 서버에서 실행시키는 명령어가 아니라 로컬에서 사용하는 명령어이에요.. 저처럼 댕청하게 서버에서 하지 마시길..
그리고 그리고 일반적으로 윈도우에서는 사용자 폴더에서 `.ssh/` 에 저장하는게 국룰일거에요
`C:\Users\User\.ssh\knockon.pem`
처럼요..

아마 wsl 이나 cmd에서 모두 작동할거에요! 맥..은 잘몰라요..ㅠ

# 서버 정리
근데 이렇게 키를 잘 옮기고 나서 보면 개인키를 `/tmp`와 홈디렉토리 2가지에 저장하고 있어요. 
그래서 `/tmp`에는 있을 필요도 없고 취약한 공간이므로 지워야 함당

- 불필요한 키파일 제거
`rm tmp/knockon_[계정명].pem`

# VSC 설정
VSC를 사용하면 작업 능률이 많이 올라갈 겁니다!!
일단 extension에서 remote라고 검색하면 ssh remote 어쩌구하는 extension이 있을거에요
그거 일단 설치하구

그러면 모니터에 >< 이런 모양의 버튼이 생길건데 거기서 톱니바퀴 모양을 누르면 
`C:\Users\User\.ssh\config` 항목이 있을거에요 그걸 누르면 어떤 스크립트가 나오는건데..
기존에 뭐 있으면 걍 아래에 이어서 작성하면 되요!

저는 foo1이라는 닉네임을 사용해서 아래와 같이 작성했어요..
```
Host knockon-ubuntu
    HostName ssh.knock-on.org
    User ubuntu
    IdentityFile C:/Users/User/.ssh/knockon.pem
    IdentitiesOnly yes

Host knockon-foo1
    HostName ssh.knock-on.org
    User foo1
    IdentityFile C:/Users/User/.ssh/knockon_foo1.pem
    IdentitiesOnly yes
```

이렇게 한 다음 저장하고 새로고침 몇 번하면 2개의 호스트가 보일건데
`knockon-ubuntu` 이게 root로 들어가고
`knockon-foo1` 이게 여러분들이 만든 계정으로 접속할 수 있게 해줄겁니다..!

이제 서버에서 작업을 하고 싶다! 그러면 그냥 VSC만 딸깍하면 바아아아로 접속할 수 있게 된겁니다 ㅅㅅ~

여기까지 오느라 고생하셨슴다.. 모두 화이팅..