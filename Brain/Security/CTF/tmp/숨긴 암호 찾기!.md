# 키워드
- PNG - CRC 체크섬

# 풀이 과정


사진 크기에 비해 용량이 비이상적으로 큼
![[스크린샷 2023-12-21 143559.png]]


- png파일 내부에는 헤더에 이상이 있는지 체크하는 crc 체크섬이 있는데 이를 이용해 의도적으로 작게 설정된 파일의 크기를 복원할 수 있음 
- 0x10부터가 크기 관련 정보 0x10줄 마지막이 crc 체크섬
![[스크린샷 2023-12-21 140413.png]]


- CRC 체크섬을 이용해 크기를 알아내는 스크립
```python
import os

import binascii

import struct

  

misc = open("target.png","rb").read()

  

for i in range(2000):

    for j in range(2000):

        data = misc[12:16] + struct.pack('>i',i) + struct.pack('>i',j)+ misc[24:29]

        crc32 = binascii.crc32(data) & 0xffffffff

        if crc32 == 0xD6FEE5F4: # CRC32

            print(struct.pack('>i',i)+ struct.pack('>i',j))
```



- 스크립트 결과를 이용해 기존의 가로 세로 크기를 알아낼 수 있고, 헤더를 다시 복원하여 flag를 획득할 수 있음

![[스크린샷 2023-12-21 165955.png]]
